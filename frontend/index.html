<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <!--Font awesome -->
    <script src="https://kit.fontawesome.com/0dc9a3d75b.js" crossorigin="anonymous"></script>
    <!--Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Montserrat|Ubuntu&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css?family=Merriweather&display=swap" rel="stylesheet" />
    <!--Bootstrap -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous" />
    <!--Bootstrap Scripts -->
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

    <!--CSS Files -->
    <link rel="stylesheet" href="styles.css" />

    <title>AppName</title>

    <script src="https://apis.google.com/js/api.js"></script>
    <script>
        function authenticate() {
            return gapi.auth2
                .getAuthInstance()
                .signIn({
                    scope: "https://www.googleapis.com/auth/youtube.readonly",
                })
                .then(
                    function() {
                        console.log("Sign-in successful");
                    },
                    function(err) {
                        console.error("Error signing in", err);
                    }
                );
        }

        function loadClient() {
            gapi.client.setApiKey("AIzaSyAv5equY4Ih4Mnrg5Hm9_0roDfpF2crI5E");
            return gapi.client
                .load("https://www.googleapis.com/discovery/v1/apis/youtube/v3/rest")
                .then(
                    function() {
                        console.log("GAPI client loaded for API");
                    },
                    function(err) {
                        console.error("Error loading GAPI client for API", err);
                    }
                );
        }
        // Make sure the client is loaded and sign-in is complete before calling this method.
        function execute() {
            var elCountryCode = document.getElementById("countriesList");
            var countryCode =
                elCountryCode.options[elCountryCode.selectedIndex].value;
            displayCountryInfo(countryCode);

            return gapi.client.youtube.videos
                .list({
                    part: "snippet,contentDetails,statistics",
                    chart: "mostPopular",
                    regionCode: countryCode,
                })
                .then(
                    function(response) {
                        document.getElementById("countryInfo").style.display = "block";
                        var iframes = document.getElementsByTagName("iframe");
                        for(var i = 0; i < iframes.length; i++) {
                           iframes[i].style.display = "inline";
                        }
                        for (var i = 0; i < 5; i++) {
                            var iframeId = "video" + i;
                            var videoId = response.result.items[i].id;
                            document.getElementById(iframeId).width = 560;
                            document.getElementById(iframeId).height = 315;
                            document.getElementById(iframeId).src =
                                "https://www.youtube.com/embed/" + videoId;
                            document.getElementById(iframeId).frameborder = 0;
                            document.getElementById(iframeId).allow =
                                "accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture";
                            document.getElementById(iframeId).allowfullscreen = "true";
                        }
                    },
                    function(err) {
                        console.error("Execute error", err);
                    }
                );
        }
        gapi.load("client:auth2", function() {
            gapi.auth2.init({
                client_id: "578129708410-8lrl3jn90f31uu7ngg0lp6d66o6s8k3t.apps.googleusercontent.com",
            });
        });

        function showCountries() {
            fetch("https://restcountries.eu/rest/v2/all")
                .then((res) => res.json())
                .then(function(data) {
                    for (var i = 0; i < data.length; i++) {
                        var option = document.createElement("OPTION");
                        option.innerHTML = data[i].name;
                        option.value = data[i].alpha2Code;
                        document.getElementById("countriesList").appendChild(option);
                    }
                })
                .catch((err) => console.log("Error:", err));
        }

        function displayCountryInfo(countryByAlpha2Code) {
            fetch("https://restcountries.eu/rest/v2/all")
                .then((res) => res.json())
                .then(function(data) {
                    const countryData = data.find(
                        (country) => country.alpha2Code === countryByAlpha2Code
                    );
                    document.querySelector("#flag-container img").src =
                        countryData.flag;
                    document.querySelector(
                        "#flag-container img"
                    ).alt = `Flag of ${countryData.name}`;
                    document.querySelector("#flag-container img").width = 300;
                    document.getElementById("capital").innerHTML = countryData.capital;
                    document.getElementById(
                        "population"
                    ).innerHTML = countryData.population.toLocaleString("en-US");
                    document.getElementById(
                            "currencies"
                        ).innerHTML = countryData.currencies
                        .filter((c) => c.name)
                        .map((c) => `${c.name} (${c.code})`)
                        .join(", ");
                    document.getElementById("region").innerHTML = countryData.region;
                    document.getElementById("subregion").innerHTML =
                        countryData.subregion;
                })
                .catch((err) => console.log("Error:", err));
        }
    </script>
</head>

<body>
    <div class="container">
        <button id="login-btn" onclick="authenticate().then(loadClient)">
        Login
      </button>

        <div id="info-container">
            <label for="">Select country</label>
            <select id="countriesList" class="center" onclick="showCountries()"></select>
            <div id="countryInfo">
                <p>Capital: <span id="capital"></span></p>
                <p>Population: <span id="population"></span></p>
                <p>Currencies: <span id="currencies"></span></p>
                <p>Region: <span id="region"></span></p>
                <p>Subregion: <span id="subregion"></span></p>
            </div>

            <div id="flag-container">
                <img id="img-flag" src="" alt="" />
            </div>
        </div>
        <button class="showvideos-btn" onclick="execute()">ShowVideos</button>
        <div class="row center">
            <div class="col-lg-6 iframePosition">
                <iframe  id="video0"></iframe>
            </div>
            <div class="col-lg-6 iframePosition">
                <iframe  id="video1"></iframe>
            </div>
            <div class="col-lg-6 iframePosition">
                <iframe id="video2"></iframe>
            </div>
            <div class="col-lg-6 iframePosition">
                <iframe  id="video3"></iframe>
            </div>
            <div class="col-lg-12 iframePosition">
                <iframe id="video4"></iframe>
            </div>
        </div>
    </div>
</body>

</html>